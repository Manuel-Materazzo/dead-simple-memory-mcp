<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Memory Server</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>MCP Memory Server</h1>
            <span id="stats" class="stats">Loading...</span>
        </header>

        <div class="stats-panel" id="statsPanel">
            <div class="stat-item">
                <span class="stat-value" id="statMemories">-</span>
                <span class="stat-label">Memories</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="statStorage">-</span>
                <span class="stat-label">Storage</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="statActivity">-</span>
                <span class="stat-label">Last Activity</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="statModel">-</span>
                <span class="stat-label">Embedding Model</span>
            </div>
        </div>

        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Search memories...">
            <button class="btn" id="clearSearch" style="display: none;">Clear</button>
            <button class="btn btn-primary" id="addBtn">+ Add Memory</button>
        </div>

        <div class="toolbar">
            <span class="toolbar-label">Data Operations:</span>
            <button class="btn btn-small" id="exportBtn" title="Export memories">↓ Export</button>
            <button class="btn btn-small" id="importBtn" title="Import memories">↑ Import</button>
        </div>
        
        <input type="file" id="importFileInput" accept=".json" style="display: none;">

        <div id="memoryList" class="memory-list"></div>

        <div id="pagination" class="pagination" style="display: none;">
            <button class="btn btn-small" id="prevPage">← Previous</button>
            <span id="pageInfo">Page 1 of 1</span>
            <button class="btn btn-small" id="nextPage">Next →</button>
        </div>
    </div>

    <div id="addModal" class="modal-overlay hidden">
        <div class="modal">
            <h2>Add New Memory</h2>
            <textarea id="newMemoryContent" placeholder="Enter memory content..."></textarea>
            <div class="metadata-input-section">
                <label class="metadata-edit-label">Metadata (JSON, optional):</label>
                <textarea id="newMemoryMetadata" class="metadata-textarea" placeholder='{"key": "value"}'></textarea>
            </div>
            <div id="conflictWarning" class="conflict-warning" style="display: none;"></div>
            <div class="modal-actions">
                <button class="btn" id="cancelAdd">Cancel</button>
                <button class="btn btn-primary" id="saveMemory">Save</button>
                <button class="btn btn-primary" id="forceSave" style="display: none;">Save Anyway</button>
            </div>
        </div>
    </div>

    <div id="deleteModal" class="modal-overlay hidden">
        <div class="modal modal-small">
            <h2>Delete Memory</h2>
            <p>Are you sure you want to delete this memory?</p>
            <div class="modal-actions">
                <button class="btn" id="cancelDelete">Cancel</button>
                <button class="btn btn-danger" id="confirmDelete">Delete</button>
            </div>
        </div>
    </div>

    <div id="importModal" class="modal-overlay hidden">
        <div class="modal">
            <h2>Import Memories</h2>
            <div id="importPreview" class="import-preview">
                <p>No file selected</p>
            </div>
            <div class="toggle-section">
                <label class="toggle-label">
                    <input type="checkbox" id="clearBeforeImport">
                    <span class="toggle-slider"></span>
                    <span class="toggle-text">Clear existing memories before import</span>
                </label>
                <p class="toggle-warning" id="clearWarning" style="display: none;">
                    ⚠️ This will permanently delete all current memories
                </p>
            </div>
            <div id="importProgress" class="import-progress" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="importProgressFill"></div>
                </div>
                <span id="importProgressText">Importing...</span>
            </div>
            <div class="modal-actions">
                <button class="btn" id="cancelImport">Cancel</button>
                <button class="btn btn-primary" id="confirmImport" disabled>Import</button>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
